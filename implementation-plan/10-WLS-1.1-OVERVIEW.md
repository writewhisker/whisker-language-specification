# WLS 1.1 Implementation Plan Overview

## Executive Summary

WLS 1.1 is a minor version release that adds advanced flow control, enhanced tooling, and completes the test/documentation infrastructure. This release focuses on features that improve authoring productivity without breaking backwards compatibility.

## Current State (Post WLS 1.0)

### Completed in WLS 1.0
- Gap 1: Parser Completeness ✅
- Gap 2: Advanced Flow Control (partial - gather/tunnels pending)
- Gap 3: Data Structures (LIST, ARRAY, MAP) ✅
- Gap 4: Modularity (INCLUDE, FUNCTION, NAMESPACE) ✅
- Gap 5: Presentation Layer (rich text, CSS, media, theming) ✅
- Gap 6: Developer Experience (LSP, CLI, error formatting) ✅

### Remaining for WLS 1.1
- Gap 2: Complete gather points and tunnels
- Gap 7: Tooling (import/export, publishing)
- Gap 8: Test Coverage (95%+ target)
- Gap 9: Documentation

## WLS 1.1 Feature Set

### 1. Advanced Flow Control (Gap 2 Completion)

| Feature | Source | Priority | Complexity |
|---------|--------|----------|------------|
| Gather Points | Ink | P1 | High |
| Tunnels | Ink | P1 | High |
| Inline Conditionals | Ink/Chapbook | P2 | Medium |
| Once-Only Text | Ink | P2 | Low |

### 2. Enhanced Tooling (Gap 7)

| Feature | Priority | Complexity |
|---------|----------|------------|
| Twine Import (Harlowe/SugarCube) | P1 | High |
| Ink Import | P2 | High |
| ChoiceScript Import | P3 | Medium |
| Static HTML Export | P1 | Medium |
| Web App (PWA) Export | P2 | Medium |
| ePub Export | P3 | High |
| IFDB/itch.io Publishing | P2 | Medium |
| Build Pipeline | P1 | High |
| VCS Integration (diff/merge) | P3 | High |

### 3. Test Coverage (Gap 8)

| Target | Current | Goal |
|--------|---------|------|
| Lua Parser | 85% | 95% |
| TypeScript Parser | 95% | 98% |
| Validators | 80% | 95% |
| Runtime | 70% | 90% |
| Corpus Tests | 100 | 200+ |

### 4. Documentation (Gap 9)

- Complete API Reference
- Tutorial Series (beginner to advanced)
- Migration Guides
- Video walkthroughs
- Community examples

## Dependencies

```
Gap 2 (Flow Control)
├── Requires: WLS 1.0 parser foundation
└── Enables: More complex story patterns

Gap 7 (Tooling)
├── Requires: Complete parser (Gap 1-6)
├── Requires: Flow control (Gap 2)
└── Enables: Professional publishing workflow

Gap 8 (Test Coverage)
├── Requires: All features implemented
└── Enables: Stable release

Gap 9 (Documentation)
├── Requires: Stable features
└── Parallel with Gaps 7-8
```

## Implementation Order

### Phase 1: Flow Control Completion (Gap 2)
1. Gather point specification and parsing
2. Gather point runtime execution
3. Tunnel specification and parsing
4. Tunnel runtime with call stack
5. Flow control validators
6. Inline conditionals
7. Once-only text

### Phase 2: Core Tooling (Gap 7.1-7.3)
1. Twine archive import
2. Harlowe syntax conversion
3. SugarCube syntax conversion
4. Static HTML export
5. Web app (PWA) export

### Phase 3: Advanced Tooling (Gap 7.4-7.6)
1. Ink import
2. IFDB integration
3. itch.io publishing
4. Build pipeline
5. Story diff/merge

### Phase 4: Quality Assurance (Gap 8)
1. Parser test expansion
2. Runtime test expansion
3. Validator test expansion
4. Corpus test expansion
5. Integration tests

### Phase 5: Documentation (Gap 9)
1. API reference completion
2. Tutorial series
3. Migration guides
4. Examples library

## Success Metrics

| Metric | WLS 1.0 | WLS 1.1 Target |
|--------|---------|----------------|
| Parser completeness | 100% | 100% |
| Test coverage | 85% | 95% |
| Corpus tests | 100 | 200+ |
| Import formats | 1 (WLS) | 5 (Twine, Ink, CS) |
| Export formats | 2 | 5+ |
| CLI commands | 5 | 10+ |
| Documentation pages | 15 | 50+ |

## Timeline Considerations

WLS 1.1 is designed for incremental delivery:
- Each gap can be released independently
- Tooling can ship before all tests complete
- Documentation updates continuously

## Backwards Compatibility

WLS 1.1 maintains full backwards compatibility with WLS 1.0:
- All WLS 1.0 syntax remains valid
- No breaking API changes
- New features are additive
- Deprecations (if any) include migration path

## Risk Assessment

| Risk | Impact | Mitigation |
|------|--------|------------|
| Gather/tunnel complexity | High | Incremental implementation |
| Import format variations | Medium | Extensive test corpus |
| Documentation scope | Medium | Community contributions |
| Test coverage gaps | Low | Automated coverage tracking |

## Next Steps

1. Review and approve WLS 1.1 scope
2. Begin Gap 2 completion (gather/tunnels)
3. Start Gap 7 Twine import in parallel
4. Expand test corpus continuously
