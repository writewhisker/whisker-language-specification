# Stage 1.21: Test Corpus - Validation Tests Part 2

## Objective
Create validation test corpus for variable and flow errors.

## Files to Create
- `phase-4-validation/test-corpus/validation/variable-tests.yaml`
- `phase-4-validation/test-corpus/validation/flow-tests.yaml`

## Prompt

```
Create additional validation test files:

1. Create phase-4-validation/test-corpus/validation/variable-tests.yaml:

# Variable (VAR) validation tests

- name: var-001-undefined-read
  description: Reading undefined variable
  input: |
    :: Start
    Your score is $score
  expected:
    valid: false
    errors:
      - code: WLS-VAR-001

- name: var-001-defined-then-read
  description: Variable defined before use (valid)
  input: |
    :: Start
    {do $score = 0}
    Your score is $score
  expected:
    valid: true
    errors: []

- name: var-002-unused-variable
  description: Variable defined but never read
  input: |
    :: Start
    {do $unused = 42}
    Hello world
  expected:
    valid: true
    warnings:
      - code: WLS-VAR-002

- name: var-003-invalid-name-number
  description: Variable name starting with number
  input: |
    :: Start
    {do $123var = 1}
  expected:
    valid: false
    errors:
      - code: WLS-VAR-003

- name: var-005-temp-scope-violation
  description: Temp variable used outside passage
  input: |
    :: Start
    {do $_local = 1}
    + [Go] -> Other

    :: Other
    Value is $_local
  expected:
    valid: false
    errors:
      - code: WLS-VAR-005

- name: var-007-reserved-name
  description: Using reserved variable name
  input: |
    :: Start
    {do $whisker = 1}
  expected:
    valid: false
    errors:
      - code: WLS-VAR-007

2. Create phase-4-validation/test-corpus/validation/flow-tests.yaml:

# Flow (FLW) validation tests

- name: flw-001-dead-end
  description: Passage with no exit
  input: |
    :: Start
    + [Go] -> DeadEnd

    :: DeadEnd
    This goes nowhere.
  expected:
    valid: true
    warnings:
      - code: WLS-FLW-001
        location:
          passage: DeadEnd

- name: flw-001-has-choice
  description: Passage with choices is not dead end
  input: |
    :: Start
    + [A] -> A
    + [B] -> B

    :: A
    + [Back] -> Start

    :: B
    + [Back] -> Start
  expected:
    valid: true
    warnings: []

- name: flw-001-end-allowed
  description: END passage allowed as dead end
  input: |
    :: Start
    + [Finish] -> END

    :: END
    The end.
  expected:
    valid: true
    warnings: []

- name: flw-003-simple-cycle
  description: Detects simple cycle
  input: |
    :: Start
    + [A] -> A

    :: A
    + [B] -> B

    :: B
    + [A] -> A
  expected:
    valid: true
    info:
      - code: WLS-FLW-003

- name: flw-004-infinite-loop
  description: Unconditional redirect loop
  input: |
    :: Start
    -> A

    :: A
    -> B

    :: B
    -> A
  expected:
    valid: true
    warnings:
      - code: WLS-FLW-004

- name: flw-004-self-redirect
  description: Self-redirect infinite loop
  input: |
    :: Start
    -> Loop

    :: Loop
    -> Loop
  expected:
    valid: true
    warnings:
      - code: WLS-FLW-004

- name: flw-003-cycle-with-choices
  description: Cycle with choices (not infinite)
  input: |
    :: Start
    + [Loop] -> A

    :: A
    + [Continue] -> B

    :: B
    + [Back] -> A
    + [Exit] -> END
  expected:
    valid: true
    info:
      - code: WLS-FLW-003
```

## Expected Output
~150 lines per file.

## Verification
```bash
cd ~/code/github.com/whisker-language-specification-1.0/phase-4-validation

# Total validation tests
grep -r "^- name:" test-corpus/validation/*.yaml | wc -l
# Expected: 25+
```

## Next Stage
1.22-cross-platform-verification.md
