# Stage 1.20: Test Corpus - Validation Tests Part 1

## Objective
Create validation test corpus for structure and link errors.

## Files to Create
- `phase-4-validation/test-corpus/validation/structure-tests.yaml`
- `phase-4-validation/test-corpus/validation/link-tests.yaml`

## Prompt

```
Create validation test files in the specification repo:

1. Create directory: phase-4-validation/test-corpus/validation/

2. Create phase-4-validation/test-corpus/validation/structure-tests.yaml:

# Structure (STR) validation tests

- name: str-001-missing-start
  description: Story without Start passage
  input: |
    :: NotStart
    This is not the start.
  expected:
    valid: false
    errors:
      - code: WLS-STR-001
        severity: error

- name: str-001-has-start
  description: Story with Start passage (valid)
  input: |
    :: Start
    Welcome!
  expected:
    valid: true
    errors: []

- name: str-002-unreachable
  description: Passage not reachable from Start
  input: |
    :: Start
    + [Go] -> A

    :: A
    Reachable

    :: Orphan
    Not reachable
  expected:
    valid: true
    warnings:
      - code: WLS-STR-002
        location:
          passage: Orphan

- name: str-003-duplicate-exact
  description: Exact duplicate passage names
  input: |
    :: Start
    First

    :: Start
    Second
  expected:
    valid: false
    errors:
      - code: WLS-STR-003

- name: str-003-duplicate-case
  description: Case-insensitive duplicate
  input: |
    :: Start
    First

    :: START
    Second
  expected:
    valid: false
    errors:
      - code: WLS-STR-003

- name: str-004-empty-passage
  description: Passage with no content
  input: |
    :: Start
    + [Go] -> Empty

    :: Empty
  expected:
    valid: true
    warnings:
      - code: WLS-STR-004
        location:
          passage: Empty

- name: str-004-whitespace-only
  description: Passage with only whitespace
  input: |
    :: Start
    + [Go] -> Blank

    :: Blank

  expected:
    valid: true
    warnings:
      - code: WLS-STR-004

3. Create phase-4-validation/test-corpus/validation/link-tests.yaml:

# Link (LNK) validation tests

- name: lnk-001-dead-link-choice
  description: Choice links to nonexistent passage
  input: |
    :: Start
    + [Go nowhere] -> NonExistent
  expected:
    valid: false
    errors:
      - code: WLS-LNK-001

- name: lnk-001-dead-link-redirect
  description: Redirect to nonexistent passage
  input: |
    :: Start
    -> Missing
  expected:
    valid: false
    errors:
      - code: WLS-LNK-001

- name: lnk-001-valid-special-targets
  description: Special targets are valid
  input: |
    :: Start
    + [End] -> END
    + [Back] -> BACK
  expected:
    valid: true
    errors: []

- name: lnk-002-self-link-choice
  description: Choice linking to same passage
  input: |
    :: Start
    + [Loop] -> Start
  expected:
    valid: true
    warnings:
      - code: WLS-LNK-002

- name: lnk-002-self-link-redirect
  description: Redirect to same passage
  input: |
    :: Loop
    -> Loop
  expected:
    valid: true
    warnings:
      - code: WLS-LNK-002

- name: lnk-003-special-target-case
  description: Wrong case for special target
  input: |
    :: Start
    + [End] -> end
  expected:
    valid: true
    warnings:
      - code: WLS-LNK-003

- name: lnk-004-empty-target
  description: Choice with empty target
  input: |
    :: Start
    + [Go] ->
  expected:
    valid: false
    errors:
      - code: WLS-LNK-004
```

## Expected Output
~150 lines per file, covering 15+ test cases.

## Verification
```bash
cd ~/code/github.com/whisker-language-specification-1.0/phase-4-validation

# Count tests
grep -c "^- name:" test-corpus/validation/structure-tests.yaml
grep -c "^- name:" test-corpus/validation/link-tests.yaml
```

## Next Stage
1.21-corpus-validation-tests-2.md
