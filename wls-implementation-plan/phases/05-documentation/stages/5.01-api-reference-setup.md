# Stage 5.01: API Reference Setup

## Objective
Set up API documentation generation for TypeScript and Lua.

## Files to Create
- `docs/typedoc.json`
- `whisker-core/config.ld`
- `docs/api/.gitkeep`

## Prompt

```
Set up API documentation generation:

1. Create docs/typedoc.json for TypeScript:

{
  "$schema": "https://typedoc.org/schema.json",
  "entryPoints": [
    "packages/parser/src/index.ts",
    "packages/story-models/src/index.ts",
    "packages/story-validation/src/index.ts",
    "packages/story-player/src/index.ts",
    "packages/import/src/index.ts",
    "packages/export/src/index.ts"
  ],
  "out": "docs/api/typescript",
  "name": "Whisker Editor API",
  "excludePrivate": true,
  "excludeInternal": true,
  "readme": "none",
  "navigationLinks": {
    "Docs": "https://wls.whisker.dev",
    "GitHub": "https://github.com/writewhisker"
  }
}

2. Create whisker-core/config.ld for Lua:

-- LDoc configuration
project = "Whisker Core"
title = "Whisker Core API Reference"
description = "Lua implementation of the Whisker Language Specification"
format = "markdown"
dir = "../docs/api/lua"
readme = "README.md"

file = {
  "lib/whisker/parser",
  "lib/whisker/runtime",
  "lib/whisker/validators"
}

3. Add documentation to key exports:

TypeScript example:
/**
 * Parse WLS source code into a Story object.
 *
 * @param source - The WLS source code to parse
 * @returns The parsed Story object
 * @throws ParseError if the source is invalid
 *
 * @example
 * ```typescript
 * const story = parse(':: Start\\nHello world!');
 * console.log(story.passages[0].name); // "Start"
 * ```
 */
export function parse(source: string): Story;

Lua example:
--- Parse WLS source code into a story table.
-- @param source string The WLS source code
-- @return table The parsed story
-- @usage
-- local story = parser.parse(":: Start\nHello world!")
-- print(story.passages[1].name) -- "Start"
function M.parse(source)

4. Generate documentation:

cd whisker-editor-web && pnpm typedoc
cd whisker-core && ldoc .
```

## Expected Output
~50 lines of configuration + documentation comments added.

## Verification
```bash
# Generate TypeScript docs
pnpm typedoc --out docs/api/typescript

# Generate Lua docs
ldoc .

# Check output
ls docs/api/typescript/
ls docs/api/lua/
```

## Next Stage
5.02-tutorial-beginner.md
