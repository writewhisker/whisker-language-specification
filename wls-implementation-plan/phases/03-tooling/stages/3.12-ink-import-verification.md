# Stage 3.12: Ink Import Verification

## Objective
Verify and complete Ink format import coverage.

## Dependencies
- Stage 3.05 (Import framework)

## Parallelization
- Can run in parallel with 3.11, 3.13, 3.16

## Files to Modify
- `packages/adapter-ink/src/index.ts`
- `packages/import/src/formats/InkImporter.ts` (create if needed)

## Prompt

```
Verify and complete Ink import:

1. Audit existing adapter-ink implementation:
   - Check coverage of Ink features
   - Document what's supported vs missing
   - Identify conversion accuracy issues

2. Ink features to verify/implement:

   BASIC SYNTAX:
   - Knots (=== knot_name ===) -> :: KnotName
   - Stitches (= stitch_name) -> :: Knot::Stitch or :: Knot_Stitch
   - Choices (* / +) -> + / * choices
   - Diverts (-> target) -> -> Target
   - Glue (<>) -> (line continuation)

   FLOW CONTROL:
   - Gathers (-) -> - gather points
   - Nested choices/gathers -> nested - markers
   - Tunnels (-> tunnel ->) -> -> Tunnel ->
   - Tunnel return (->->) -> <-
   - Threads (<- thread) -> (WLS 2.0 or approximation)

   VARIABLES:
   - VAR x = 5 -> $x = 5
   - ~ x = 10 -> {do $x = 10}
   - {x} -> $x
   - {x > 5: text} -> {$x > 5: text | }

   CONDITIONALS:
   - {condition: text} -> {cond: text | }
   - {condition} ... {/} -> { cond }...{/}
   - {- condition: text} switch -> {cond}text{elif...}{/}

   ALTERNATIVES:
   - {~shuffle} -> {~| opt1 | opt2}
   - {&cycle} -> {&| opt1 | opt2}
   - {!once} -> {!| opt1 | opt2}
   - Sequences -> {| opt1 | opt2 | final}

   ADVANCED:
   - Functions -> (warn: partial support)
   - Lists/Sets -> LIST declarations
   - External functions -> EXTERNAL

3. Create comprehensive test matrix:

   | Feature | Ink Syntax | WLS Output | Status |
   |---------|------------|------------|--------|
   | Knot | === name === | :: Name | ✅/⚠️/❌ |
   | Stitch | = name | :: Parent::Name | |
   | Choice | * [text] | + [text] | |
   | Gather | - | - | |
   | Tunnel | -> x -> | -> X -> | |
   | ... | | | |

4. Create packages/import/src/formats/InkImporter.ts if missing:

   - Wrapper around adapter-ink
   - Implements Importer interface
   - Provides loss report
   - Handles error cases

5. Add integration tests with real Ink stories:
   - The Intercept (basic)
   - Crime Scene (variables)
   - Glass (complex flow)
```

## Expected Output
~200 lines importer/adapter updates + verification report.

## Verification
```bash
pnpm --filter @writewhisker/import test -- --run Ink
pnpm --filter @writewhisker/adapter-ink test
```

## Success Criteria
- [ ] Coverage matrix documented
- [ ] All basic Ink features convert correctly
- [ ] Flow control (gathers, tunnels) verified
- [ ] Variables and conditionals verified
- [ ] Loss report accurate for unsupported features
- [ ] Integration tests with real Ink stories pass

## Next Stage
3.13-watch-mode.md
